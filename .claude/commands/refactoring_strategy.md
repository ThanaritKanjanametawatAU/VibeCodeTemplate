Refactor code: $ARGUMENTS

1. ADD TESTS FIRST - ensure behavior preserved
2. REFACTOR incrementally:
   - Extract methods for clarity
   - Remove duplication
   - Improve naming
   - Apply patterns
   - Reduce complexity
3. MODERNIZE syntax & dependencies
4. ADD types if missing
5. VERIFY tests pass after each change
6. DOCUMENT architectural decisions

Never refactor without test coverage!